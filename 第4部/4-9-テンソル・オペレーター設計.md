# 第 9 章　テンソル・オペレーター設計

テンソル演算を効率よく実装するための型設計と GPU カーネル設計についてまとめます。

## 9.1 テンソル構造体とストライド設計

テンソルのメタデータ（形状、ストライド、データポインタ）を明確に分離します。ストライド設計はビュー操作や転置を低コストで実現するために重要です。

## 9.2 基本演算（加算・積・畳み込み）の GPU 実装

加算やスケーリングは要素単位で並列化しやすい一方、畳み込みはデータ再利用とメモリアクセスの最適化が鍵です。カーネル側でのループ展開や共有メモリの活用を検討します。

## 9.3 カーネル融合（Fusion）による最適化

複数の小さいカーネルを融合してメモリ読み書き回数を削減することで大幅な性能向上が期待できます。自動的に融合する仕組みと手動で設計する場合の利点・欠点を整理します。

## 9.4 勾配計算と逆伝播実装

各演算の逆伝播（勾配ルーチン）を効率的に実装するために、順伝播での中間値の保存と再計算（チェックポイント）とのトレードオフを評価します。
